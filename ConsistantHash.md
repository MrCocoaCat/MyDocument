1.取余算法

优点：数据分布均匀
缺点：当服务器动态的添加、删除节点或者某台server down掉，会导致命中率超大幅度下降，甚至导致服务不可用
![](assets/markdown-img-paste-20180907103543415.png)

2.Consistant Hash算法：一致性哈希算法

表现为一个封闭的圆环，圆环上的点分别代表0~2^32。各个memcached节点根据hash算法，分别占据圆环上的一个点，当某key进行存储操作，会针对key进行hash操作，hash后也是圆环上的一个点，那么这个key将被存储在顺时针方向的第一个节点上。
![](assets/markdown-img-paste-20180907103552219.png)
如上图：分配不均的节点，此时key将会被存储到节点C上。

此时，我们新增节点D，如下图。受影响的部分只有节点A~节点D中间的部分，这边分数据不会再映射到节点B上，而是映射到新增节点D上。减掉一个节点同理，只影响顺时针后面一个节点。
![](assets/markdown-img-paste-20180907103609106.png)
优点：动态的增删节点，服务器down机，影响的只是顺时针的下一个节点
缺点：当服务器进行hash后值较为接近会导致在圆环上分布不均匀，进而导致key的分布、服务器的压力不均匀。若中间某一权重较大的serverdown机，命中率下降明显



3.Consistant Hash算法 + 虚拟节点

![](assets/markdown-img-paste-20180907103622265.png)
引入虚拟节点的思想，解决一致性hash算法分布不均导致负载不均的问题。一个真实节点对应若干个虚拟节点，当key被映射到虚拟节点上时，则被认为映射到虚拟节点所对应的真实节点上。
优点：引入虚拟节点的思想，每个物理节点对应圆环上若干个虚拟节点（比如200~300个），当keyhash到虚拟节点，就会存储到实际的物理节点上，有效的实现了负载均衡
